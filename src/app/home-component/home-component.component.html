<div class="border-bottom mb-3 text-center" *ngIf="!dataState.hasLoadedData">

  <div class="card m-auto my-4" style="width: 22rem;">
    <div class="card-body">
      <h5 class="card-title">Finanz Uhu</h5>
      <p class="card-text">Das datenschutzfreundliche Tool um deine Finanzdateien auf deinem Computer zu analysieren</p>
 
      <ul class="list-group">
        <li class="list-group-item">Alle Daten werden auf deinem Computer verarbeitet</li>
        <li class="list-group-item">Open Source</li>
        <li class="list-group-item">Unterstützt ING und Sparkassen Dateien</li>
      </ul>
    </div>
  </div>

  <h2>Wähle eine Datei</h2>
  <app-file-selector [big]="true"></app-file-selector>  
  <div class="text-center">
    <caption class="m-auto d-inline-block">Wähle eine <i>.csv</i> Datei von der Sparkasse oder ING aus.</caption>
  </div>
</div>

<div *ngIf="dataState.hasLoadedData">

  <div class="mb-3">
    <app-date-range-picker [from]="dataState.currentFilter.from" [to]="dataState.currentFilter.to"></app-date-range-picker>
    <!-- <mat-form-field>
      <mat-date-range-input [rangePicker]="picker">
        <input matStartDate placeholder="Start date" [(ngModel)]="dataState.currentFilter.from" (dateChange)="refreshData()">
        <input matEndDate placeholder="End date" [(ngModel)]="dataState.currentFilter.to" (dateChange)="refreshData()">
      </mat-date-range-input>
      <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-date-range-picker #picker></mat-date-range-picker>
    </mat-form-field> -->

    <div ngbDropdown class="d-inline-block ms-3">
      <button type="button" class="btn btn-outline-primary" id="dropdownBasic1" ngbDropdownToggle>
        <span *ngIf="hasSelectedMonth()">{{dataState.currentFilter.from | date}}</span>
        <span *ngIf="!hasSelectedMonth()">Monate</span>
        <!-- {{hasSelectedMonth() ? selectedMonth().name : 'Monat'}} -->
      </button>
      <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
        <button ngbDropdownItem (click)="dataState.resetMonth()">Alle</button>
        <button ngbDropdownItem (click)="dataState.filterByDateFilter(date)" *ngFor="let date of dataState.months"
          [ngClass]="{'bg-primary text-white': isSelectedMonth(date)}">{{date.name}}</button>
      </div>
    </div>

    <div ngbDropdown class="d-inline-block ms-3">
      <button type="button" class="btn btn-outline-primary" id="dropdownBasic1" ngbDropdownToggle>
        <span>Ein- / Ausgaben</span>
      </button>
      <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
        <button ngbDropdownItem (click)="dataState.filterByType('all')"> Alle </button>
        <button ngbDropdownItem (click)="dataState.filterByType('income')"> Einnahmen </button>
        <button ngbDropdownItem (click)="dataState.filterByType('expense')"> Ausgaben </button>
      </div>
    </div>
  </div>

  <app-category-select></app-category-select>

  <div class="row">
    <div class="col-md-8">
      <app-history-chart [dates]="dataState.monthStarts" [transactions]="dataState.selectedTransactions"></app-history-chart>
    </div>
    <div class="col-md-4">
      <app-category-chart [data]="dataState.categories"></app-category-chart>
    </div>
  </div>

  <ul class="nav nav-tabs">
    <li class="nav-item" *ngFor="let tab of tabs">
      <a class="nav-link" [ngClass]="{'active': tab == activeTab}" aria-current="page" href="#" (click)="activeTab = tab">{{tab}}</a>
    </li>

  </ul>
  <div class="border-start border-bottom border-end p-3">
    <div *ngIf="activeTab == 'Kategorien'">
      <h2>Kategorien</h2>
      <app-category-overview-component *ngIf="!dataState.currentFilter.category" [amountMonths]="dataState.selectedMonthAmountInDataRangeFilter"
        [categorySummaries]="dataState.categories"></app-category-overview-component>
      <app-category-component *ngIf="dataState.currentFilter.category" [amountMonths]="dataState.selectedMonthAmountInDataRangeFilter"
        [categorySummary]="dataState.currentFilter.category" [expanded]="true"></app-category-component>
    </div>

    <div *ngIf="activeTab == 'Wiederkehrende'">
      <h2>Wiederkehrende</h2>
      <div class="row">
        <div class="col">

          <app-transaction-component *ngFor="let transaction of dataState.duplicates | orderBy: 'amount'" [transaction]="transaction">
          </app-transaction-component>
        </div>
      </div>


    </div>
    <div *ngIf="activeTab == 'Alle'">
      <!-- <app-transaction-overview></app-transaction-overview> -->
      <h2>Alle</h2>

      <div class="row">
        <div class="col">


          <app-transaction-component *ngFor="let transaction of dataState.selectedTransactions | orderBy: 'amount'" [transaction]="transaction">
          </app-transaction-component>

        </div>
      </div>


    </div>
  </div>


</div>